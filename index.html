<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="center-indicator"></div>
    <div class="carousel-container">
        <div class="carousel-track">
            <div class="carousel-item">Elemento 1: Lorem ipsum dolor sit amet</div>
            <div class="carousel-item">Elemento 2: Consectetur adipiscing elit</div>
            <div class="carousel-item">Elemento 3: Sed do eiusmod tempor</div>
            <div class="carousel-item">Elemento 4: Ut labore et dolore magna</div>
            <div class="carousel-item">Elemento 5: Ut enim ad minim veniam</div>
            <div class="carousel-item">Elemento 6: Quis nostrud exercitation</div>
            <div class="carousel-item">Elemento 7: Lorem ipsum dolor sit amet</div>
            <div class="carousel-item">Elemento 8: Consectetur adipiscing elit</div>
        </div>
    </div>

    <div class="textContainer">
        <span class="hearts particlesText">_________________________________________________ </span>
    </div>
   
    <script>
        // Función para inicializar las partículas
        function initiParticles(){
            hearts();
        }

        function hearts(){
            $.each($(".particlesText.hearts"), function(){
                var heartcount = ($(this).width() / 50) * 5;
                for (var i = 0; i < heartcount; i++){
                    var size = ($.rnd(60,120) / 10);
                    $(this).append('<span class="particle" style="top:' + $.rnd(20,80) + '%; left:' + $.rnd(0,95) + '%; width:' + size + 'px; height:' + size + 'px; animation-delay:' + ($.rnd(0, 30) / 10 ) + 's;"></span>');
                }
            });
        }

        // Definir función $.rnd() para generar números aleatorios
        jQuery.rnd = function(m, n){
            m = parseInt(m);
            n = parseInt(n);
            return Math.floor(Math.random() * (n - m + 1) + m);
        }

        // Ejecutar la función de partículas
        $(document).ready(function(){
            initiParticles();
        });
    </script>

    <script>
        const container = document.querySelector('.carousel-container');
        const items = document.querySelectorAll('.carousel-item');
        const centerIndicator = document.querySelector('.center-indicator');

        // Posicionar el indicador del centro
        function updateCenterIndicator() {
            centerIndicator.style.top = `${window.innerHeight / 2}px`;
        }
        updateCenterIndicator();

        function easeInOutQuad(x) {
            return x < 0.5 ? 2 * x * x : 1 - Math.pow(-2 * x + 2, 2) / 2;
        }

        function getSmoothScale(distance) {
            // Distancia máxima para el efecto (ajusta este valor según necesites)
            const maxDistance = 600;
            
            // Normalizar la distancia a un valor entre 0 y 1
            const normalizedDistance = Math.min(distance / maxDistance, 1);
            
            // Calcular la escala usando una función suave
            // Esto dará una escala entre 1 (cuando distance = 0) y 0.4 (cuando distance >= maxDistance)
            const scale = 1 - (0.6 * easeInOutQuad(normalizedDistance));
            
            return Math.max(0.4, scale);
        }

        function getSmoothOpacity(distance) {
            const maxDistance = 400;
            const normalizedDistance = Math.min(distance / maxDistance, 1);
            const opacity = 1 - (0.8 * easeInOutQuad(normalizedDistance));
            return Math.max(0.2, opacity);
        }

        function updateScale() {
            const windowCenter = window.innerHeight / 2;
            
            items.forEach(item => {
                const rect = item.getBoundingClientRect();
                const itemCenter = rect.top + (rect.height / 2);
                const distanceFromCenter = Math.abs(windowCenter - itemCenter);
                
                // Aplicar escala y opacidad suaves
                const scale = getSmoothScale(distanceFromCenter);
                const opacity = getSmoothOpacity(distanceFromCenter);

                item.style.transform = `scale(${scale})`;
                item.style.opacity = opacity;
            });
        }

        // Centrar el primer elemento al cargar
        function centerFirstElement() {
            if (items.length > 0) {
                const firstItem = items[0];
                const rect = firstItem.getBoundingClientRect();
                const offset = rect.top + window.scrollY - (window.innerHeight - rect.height) / 2;
                window.scrollTo({
                    top: offset,
                    behavior: 'instant'
                });
            }
        }

        // Event Listeners
        window.addEventListener('scroll', () => {
            window.requestAnimationFrame(updateScale);
        }, { passive: true });

        window.addEventListener('resize', () => {
            updateCenterIndicator();
            updateScale();
        });

        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            centerFirstElement();
            updateScale();
        });

        // Observador de intersección para mejor rendimiento
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        updateScale();
                    }
                });
            },
            {
                root: null,
                threshold: [0, 0.5, 1]
            }
        );

        items.forEach(item => observer.observe(item));

        // Ejecutar centerFirstElement después de un pequeño delay
        setTimeout(centerFirstElement, 100);
    </script>
</body>
</html>